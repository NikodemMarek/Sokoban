<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: board/levelBuilder.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: board/levelBuilder.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module levelBuilder
 */

import BoardClickListener from '/src/input/boardClickListener.js'
import Board, { draw as drawBoard, setElement, isWall, isTarget } from '/src/board/board.js'
import Boxes, { draw as drawBoxes, addBox, removeBox, isBox } from '/src/objects/boxes.js'
import Box from '/src/objects/box.js'
import Worker, { draw as drawWorker } from '/src/objects/worker.js'

/**
 * Klasa przechowywuje informacje o obecnie edytowanym poziomie.
 */
export default class LevelBuilder {
    /**
     * Konstruktor przyjmuje i zapisuje do zmiennych {@link index:context} oraz {@link index:canvasImage}, uruchamia {@link boardClickListener:BoardClickListener} i rysuje poziom w domyślnym ustawieniu.
     * @param {CanvasRenderingContext2D} context - Context w którym jest rysowany poziom
     * @param {CanvasImage} canvasImage - CanvasImage którego będzie używać plansza
     */
    constructor(context, canvasImage) {
        this.context = context;
        this.canvasImage = canvasImage;

        /**
         * Zmienna trzymająca informacje o stanie edytora poziomów (wstrzymany / działający).
         * @type {boolean}
         */
        this.isPaused = false;
        /**
         * Wybrany przez gracza obiekt, który jest stawiany na plansz.
         * @type {string}
         */
        this.object = 'e';
        /**
         * Liczba celów ustawionych na planszy.
         * @type {number}
         */
        this.targetsNumber = 0;

        /**
         * Pudełka ustawione na planszy.
         * @see {@link boxes:Boxes}
         * @type {Boxes}
         */
        this.boxes = new Boxes();
        /**
         * Plansza która będzie edytowana.
         * @see {@link board:Board}
         * @type {Board}
         */
        this.board = new Board(
            canvasImage,
            [
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e'],
                ['e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e', 'e']
            ]
        );

        draw(this);

        this.boardClickListener = new BoardClickListener(this);
    }
};

/**
 * Funkcja rysująca poziom.
 * @param {LevelBuilder} levelBuilder - Obiekt klasy {@link LevelBuilder}
 */
export function draw(levelBuilder) {
    if(!levelBuilder.isPaused) {
        levelBuilder.canvasImage.drawBackground();

        drawBoard(levelBuilder.board, levelBuilder.canvasImage);

        drawBoxes(levelBuilder.boxes, levelBuilder.canvasImage);
        if(typeof levelBuilder.worker != 'undefined') drawWorker(levelBuilder.worker, levelBuilder.canvasImage);
    }
}
/**
 * Funkcja aktualizująca poziom, po naciśnięciu na canvas.
 * @param {LevelBuilder} levelBuilder - Obiekt klasy {@link LevelBuilder}
 * @param {index:Position} clickPosition - Pozycja w której kliknięty został canvas
 */
export function update(levelBuilder, clickPosition) {
    if(!levelBuilder.isPaused) {
        switch(levelBuilder.object) {
            case 'e':
                removeBox(levelBuilder.boxes, clickPosition);
                if(isWorker(levelBuilder.worker, clickPosition)) levelBuilder.worker = undefined;

                if(isTarget(levelBuilder.board, clickPosition)) levelBuilder.targetsNumber --;
                setElement(levelBuilder.board, clickPosition, levelBuilder.object);
                break;
            case 'w':
                if(
                    !isWorker(levelBuilder.worker, clickPosition) &amp;&amp;
                    !isBox(levelBuilder.boxes, clickPosition)
                ) setElement(levelBuilder.board, clickPosition, levelBuilder.object);
                break;
            case 't':
                if(!isTarget(levelBuilder.board, clickPosition)) {
                    setElement(levelBuilder.board, clickPosition, levelBuilder.object);

                    levelBuilder.targetsNumber ++;
                }
                break;
            case 'b':
                if(
                    !isWall(levelBuilder.board, clickPosition) &amp;&amp;
                    !isWorker(levelBuilder.worker, clickPosition) &amp;&amp;
                    !isBox(levelBuilder.boxes, clickPosition)
                ) {
                    addBox(
                        levelBuilder.boxes,
                        new Box(
                            clickPosition,
                            isTarget(levelBuilder.board, clickPosition)
                        )
                    );
                }
                break;
            case 'p':
                if(
                    !isWall(levelBuilder.board, clickPosition) &amp;&amp;
                    !isBox(levelBuilder.boxes, clickPosition)
                ) levelBuilder.worker = new Worker(clickPosition);
                break;
        }
    }
}

/**
 * Funkcja która sprawdza czy w podanej pozycji znajduje się magazynier.
 * @see {@link worker:Worker}
 * @param {Worker} worker - Obiekt klasy {@link worker:Worker}
 * @param {index:Position} position - Pozycja do sprawdzenia
 * @returns {boolean} Czy w podanej pozycji znajduje się magazynier
 */
function isWorker(worker, position) {
    if(typeof worker == 'undefined') return false;
    else return worker.position.x == position.x &amp;&amp; worker.position.y == position.y;
}

/**
 * Funkcja rozpoczynająca kreator poziomów.
 * @param {LevelBuilder} levelBuilder - Obiekt klasy {@link LevelBuilder}
 */
export function start(levelBuilder) {
    levelBuilder.isPaused = false;
    levelBuilder.boardClickListener.isPaused = false;
}
/**
 * Funkcja zatrzymująca kreator poziomów.
 * @param {LevelBuilder} levelBuilder - Obiekt klasy {@link LevelBuilder}
 */
export function stop(levelBuilder) {
    levelBuilder.isPaused = true;
    levelBuilder.boardClickListener.isPaused = true;
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-board.html">board</a></li><li><a href="module-box.html">box</a></li><li><a href="module-boxes.html">boxes</a></li><li><a href="module-constants.html">constants</a></li><li><a href="module-game.html">game</a></li><li><a href="module-gameHistory.html">gameHistory</a></li><li><a href="module-index.html">index</a></li><li><a href="module-levelBuilder.html">levelBuilder</a></li><li><a href="module-levelProvider.html">levelProvider</a></li><li><a href="module-scoreCounter.html">scoreCounter</a></li><li><a href="module-scoreHolder.html">scoreHolder</a></li><li><a href="module-worker.html">worker</a></li></ul><h3>Classes</h3><ul><li><a href="module-board.html">board</a></li><li><a href="module-box.html">box</a></li><li><a href="module-boxes.html">boxes</a></li><li><a href="module-game.html">game</a></li><li><a href="module-gameHistory.html">gameHistory</a></li><li><a href="module-levelBuilder.html">levelBuilder</a></li><li><a href="module-levelProvider.html">levelProvider</a></li><li><a href="module-scoreHolder.html">scoreHolder</a></li><li><a href="module-worker.html">worker</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sat Mar 27 2021 23:24:54 GMT+0100 (czas środkowoeuropejski standardowy)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
